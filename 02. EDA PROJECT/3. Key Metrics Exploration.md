# ðŸ”¢ Key Metrics Exploration

**************

---
## ðŸ“‹ Table of Contents
1. [*****](#table-and-view-listing)
2. [******](#column-metadata)
3. [***************](#table-size-analysis-mb)
4. [**************](#view-inspection)
5. [**********](#view-columns-metadata)
6. [**********](#view-sql-definitions)
---

## ðŸ“Œ Purpose

- âœ… **********
- âœ… ****************
- âœ… ************
- âœ… ***********

---

## Statistical Profile
```sql
DECLARE @schema_name NVARCHAR(50) = 'gold';
DECLARE @table_name NVARCHAR(50) = 'fact_payments';
DECLARE @column_name NVARCHAR(50) = 'total';
DECLARE @full_table_name NVARCHAR(100) = QUOTENAME(@schema_name) + '.' + QUOTENAME(@table_name);
DECLARE @stat_analysis NVARCHAR(MAX);

SET @stat_analysis = '
WITH stats AS (
    SELECT DISTINCT
        -- Basic statistical measures
        ROUND(AVG(' + QUOTENAME(@column_name) + ') OVER(), 2) AS mean,
        ROUND(STDEV(' + QUOTENAME(@column_name) + ') OVER(), 2) AS std_dev,
        ROUND(VAR(' + QUOTENAME(@column_name) + ') OVER(), 0) AS variance,
        MIN(' + QUOTENAME(@column_name) + ') OVER() AS min_val,
        MAX(' + QUOTENAME(@column_name) + ') OVER() AS max_val,
        -- Statistical measures for distribution analysis
        ROUND(PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY ' + QUOTENAME(@column_name) + ') OVER (), 0) AS Q1,
        ROUND(PERCENTILE_CONT(0.50) WITHIN GROUP (ORDER BY ' + QUOTENAME(@column_name) + ') OVER (), 0) AS median,
        ROUND(PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY ' + QUOTENAME(@column_name) + ') OVER (), 0) AS Q3,
        ROUND(PERCENTILE_CONT(0.90) WITHIN GROUP (ORDER BY ' + QUOTENAME(@column_name) + ') OVER (), 0) AS p90,
        ROUND(PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY ' + QUOTENAME(@column_name) + ') OVER (), 0) AS p95,
        ROUND(PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY ' + QUOTENAME(@column_name) + ') OVER (), 0) AS p99,
        -- Measures for outlier detection (IQR method)
        ROUND(PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY ' + QUOTENAME(@column_name) + ') OVER () - 
              PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY ' + QUOTENAME(@column_name) + ') OVER (), 0) AS iqr
    FROM ' + @full_table_name + '
)
SELECT category, metric, value
FROM stats
CROSS APPLY (
    VALUES
        (''basic_stat'', ''mean'', mean),
        ('''', ''std_dev'', std_dev),
        ('''', ''variance'', variance),
        ('''', ''min'', min_val),
        ('''', ''max'', max_val),

        (''distribution_percentile'', ''Q1'', Q1),
        ('''', ''median'', median),
        ('''', ''Q3'', Q3),
        ('''', ''p90'', p90),
        ('''', ''p95'', p95),
        ('''', ''p99'', p99),

        (''outlier_detection'', ''iqr'', iqr)
) AS unpivoted(category, metric, value);
';

EXEC sp_executesql @stat_analysis;
```

| Category               | Metric     | Value    |
|------------------------|------------|----------|
| **basic_stat**         | mean       | 160,99   |
|                        | std_dev    | 221,95   |
|                        | variance   | 49262    |
|                        | min        | 0        |
|                        | max        | 13664,08 |
| **distribution_percentile** | Q1        | 62   |
|                        | median     | 105      |
|                        | Q3         | 177      |
|                        | p90        | 308      |
|                        | p95        | 453      |
|                        | p99        | 1076     |
| **outlier_detection**  | iqr        | 115      |
